# 容错限流的原理


## 1. 基本的容错模式

### 1.1 超时

主动设置超时

### 1.2 限流

限制最大并发数

### 1.3 熔断

错误数达到阈值的时候，类似于保险丝的熔断，拒绝后续的请求

### 1.4 隔离

隔离不同的依赖调用，比如微服务架构设计规范下，数据库的一张表只属于某个服务

### 1.5 降级

服务降级，VIP优先或者非关键信息不展示等



## 2. 断路器模式

断路器是一种状态机。

刚开始的时候系统处于绿色，也就时正常的状态，当有错误发生的时候，断路器打开，再有请求进入的时候，会被拒绝。

但是也不是完全的拒绝，它允许一部分请求去尝试，此时处于半开的状态，当系统错误解决或者恢复之后，在慢慢恢复到关闭模式，此时系统处于正常访问的状态。

![](https://oscimg.oschina.net/oscnet/up-cfa7212ddfc1871d388a489957b063a4517.png)


## 3. 舱壁隔离技术(Bulkhead)

当一个船舱漏水了不会影响到整个船舱。仅仅影响当前的船舱。


## 4. 容错理念

1. 凡是依赖都可能会失败
2. 凡是资源都有限制 （CPU、Memory、Thread）
3. 网络并不可靠
4. 延迟是应用稳定性杀手


## 5. 弹性理念

在被弯曲，压缩或者拉伸之后，能后恢复原状的能力